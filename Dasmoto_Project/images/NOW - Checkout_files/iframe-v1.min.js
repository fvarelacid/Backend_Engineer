!function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=22)}([function(e,t,n){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var o=n(8),a=n(9),s=n(10),c={settings:{coreHost:"https://core.spreedly.com"}};function l(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:c;return"".concat(t.settings.coreHost,"/api/internal/v1/transactions/").concat(e,"/status.json")}function u(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={};return e.environmentKey&&(t["Spreedly-Environment-Key"]=e.environmentKey),t}var d=function(){function e(t,n,i,o){var s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:20,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:500,d=arguments.length>6&&void 0!==arguments[6]?arguments[6]:c;r(this,e),this.endpoint=l(t,d),this.done=n,this.handleData=this.handleData.bind(this),this.handleError=this.handleError.bind(this),this.fetchData=this.fetchData.bind(this),this.retryable=new a(s,u,this.fetchData,i),this.environmentKey=o}var t,n,d;return t=e,d=[{key:"withStatus",value:function(e,t,n,r){var i=u({environmentKey:t});o.getJSON(l(e),n,r,i)}},{key:"withContext",value:function(t,n,r,i){e.withStatus(t,n,(function(e){r(s.decode(e.transaction&&e.transaction.context)||e.transaction)}),i)}},{key:"contextFrom",value:function(e){var t=null;if(e.transaction&&e.transaction.context)try{var n=window.atob(e.transaction.context);t=window.JSON.parse(n)}catch(e){}return t}}],(n=[{key:"run",value:function(){this.retryable.runNow()}},{key:"stop",value:function(){this.retryable.stop()}},{key:"fetchData",value:function(){var e=u({environmentKey:this.environmentKey}),t=(new Date).getTime();o.getJSON("".concat(this.endpoint,"?time=").concat(t),this.handleData,this.handleError,e)}},{key:"handleData",value:function(e){return!!this.retryable.isRunning()&&(e.transaction&&e.transaction.state&&"pending"!==e.transaction.state?(this.retryable.stop(),this.done(e.transaction),!0):(this.done(e.transaction),this.retryable.runLater(),!0))}},{key:"handleError",value:function(){return!!this.retryable.isRunning()&&(this.retryable.runLater(),!0)}}])&&i(t.prototype,n),d&&i(t,d),e}();e.exports=d},function(e,t,n){"use strict";var r=n(36)();e.exports=function(e){return e!==r&&null!==e}},function(e,t,n){"use strict";e.exports={ajax:{post:function(e,t,n){var r=new XMLHttpRequest,i=JSON.parse(t);r.onreadystatechange=function(){4===r.readyState&&n(r.status,r.responseText)},r.open("POST",e,!0),r.setRequestHeader("CONTENT-TYPE","application/json"),i&&i.environment_key&&r.setRequestHeader("Spreedly-Environment-Key",i.environment_key),r.send(t)}},addListener:function(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent&&e.attachEvent("on"+t,n)},addInputListener:function(e,t){void 0===e.oninput||null===e.oninput?(this.addListener(e,"change",t),this.addListener(e,"keyup",t)):this.addListener(e,"input",t)},removeListener:function(e,t,n){e&&(e.addEventListener?e.removeEventListener(t,n,!1):e.attachEvent&&"string"==typeof t&&"function"==typeof n&&e.detachEvent("on"+t,n))},getElementWithAttribute:function(e,t){for(var n=document.getElementsByTagName(e),r=0;r<n.length;r++)if(n[r].getAttribute(t))return n[r]},domain:function(e){if(void 0!==e){var t=e.match(/^(https?:\/\/[^\/?#]+)(?:[\/?#]|$)/i);return t&&t[1]}},camelize:function(e){if(void 0!==e){var t=e.split("-");if(1===t.length)return e;for(var n=t[0],r=1;r<t.length;r++){var i=t[r];n=n+i.charAt(0).toUpperCase()+i.slice(1)}return n}},stripTags:function(e){if("string"==typeof e)return e.replace(/(<([^>]+)>)/gi,"")},setText:function(e,t){void 0!==e&&void 0!==t&&(e.textContent&&void 0!==e.textContent?e.textContent=t:e.innerText=t)},style:function(e,t,n){if(void 0!==t&&void 0!==n){var r=this.camelize(t.trim());if(this.cssProperties.indexOf(r)>=0)for(var i=0;i<e.length;i++){e[i].style[this.cssToJsProperty(r)]=n.trim()}}},removeClass:function(e,t){var n=new RegExp("(?:^|\\s)"+t+"(?!\\S)","g");e.className=e.className.replace(n,"")},hasClass:function(e,t){return!!e.className.match(new RegExp("(\\s|^)"+t+"(\\s|$)"))},addClass:function(t,n){e.exports.hasClass(t,n)||(t.className+=" "+n)},cssToJsProperty:function(e){return this.cssToJsPropertyMappings[e]||e},cssProperties:["accentColor","alignContent","alignItems","alignSelf","alignTracks","all","animation","animationDelay","animationDirection","animationDuration","animationFillMode","animationIterationCount","animationName","animationPlayState","animationTimeline","animationTimingFunction","appearance","aspectRatio","backdropFilter","backfaceVisibility","background","backgroundAttachment","backgroundBlendMode","backgroundClip","backgroundColor","backgroundImage","backgroundOrigin","backgroundPosition","backgroundPositionX","backgroundPositionY","backgroundRepeat","backgroundSize","blockSize","border","borderBlock","borderBlockColor","borderBlockEnd","borderBlockEndColor","borderBlockEndStyle","borderBlockEndWidth","borderBlockStart","borderBlockStartColor","borderBlockStartStyle","borderBlockStartWidth","borderBlockStyle","borderBlockWidth","borderBottom","borderBottomColor","borderBottomLeftRadius","borderBottomRightRadius","borderBottomStyle","borderBottomWidth","borderCollapse","borderColor","borderEndEndRadius","borderEndStartRadius","borderImage","borderImageOutset","borderImageRepeat","borderImageSlice","borderImageSource","borderImageWidth","borderInline","borderInlineColor","borderInlineEnd","borderInlineEndColor","borderInlineEndStyle","borderInlineEndWidth","borderInlineStart","borderInlineStartColor","borderInlineStartStyle","borderInlineStartWidth","borderInlineStyle","borderInlineWidth","borderLeft","borderLeftColor","borderLeftStyle","borderLeftWidth","borderRadius","borderRight","borderRightColor","borderRightStyle","borderRightWidth","borderSpacing","borderStartEndRadius","borderStartStartRadius","borderStyle","borderTop","borderTopColor","borderTopLeftRadius","borderTopRightRadius","borderTopStyle","borderTopWidth","borderWidth","bottom","boxDecorationBreak","boxShadow","boxSizing","breakAfter","breakBefore","breakInside","captionSide","caretColor","clear","clip","clipPath","color","columnCount","columnFill","columnGap","columnRule","columnRuleColor","columnRuleStyle","columnRuleWidth","columnSpan","columnWidth","columns","contain","content","contentVisibility","counterIncrement","counterReset","counterSet","cursor","direction","display","emptyCells","filter","flex","flexBasis","flexDirection","flexFlow","flexGrow","flexShrink","flexWrap","float","font","fontFamily","fontFeatureSettings","fontLanguageOverride","fontOpticalSizing","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontSynthesis","fontVariant","fontVariantAlternatives","fontVariantCaps","fontVariantEastAsian","fontVariantLigatures","fontVariantNumeric","fontVariantPosition","fontVariationSettings","fontWeight","forcedColorAdjust","gap","grid","gridArea","gridAutoColumns","gridAutoFlow","gridAutoRows","gridColumn","gridColumnEnd","gridColumnStart","gridRow","gridRowEnd","gridRowStart","gridTemplate","gridTemplateAreas","gridTemplateColumns","gridTemplateRows","hangingPunctuation","height","hyphenatedCharacter","hyphens","imageOrientation","imageRendering","imageResolution","inherit","initial","initialLetter","initialLetterAlign","inlineSize","inset","insetBlock","insetBlockEnd","insetBlockStart","insetInline","insetInlineEnd","insetInlineStart","isolation","justifyContent","justifyItems","justifySelf","justifyTracks","left","letterSpacing","lineBreak","lineHeight","lineHeightStep","listStyle","listStyleImage","listStylePosition","listStyleType","margin","marginBlock","marginBlockEnd","marginBlockStart","marginBottom","marginInline","marginInlineEnd","marginInlineStart","marginLeft","marginRight","marginTop","marginTrim","maxBlockSize","maxHeight","maxInlineSize","maxWidth","minBlockSize","minHeight","minInlineSize","minWidth","mixBlendMode","objectFit","objectPosition","offset","offsetAnchor","offsetDistance","offsetPath","offsetPosition","offsetRotate","opacity","order","orphans","outline","outlineColor","outlineOffset","outlineStyle","outlineWidth","overflow","overflowAnchor","overflowBlock","overflowClipMargin","overflowInline","overflowWrap","overflowX","overflowY","overscrollBehavior","overscrollBehaviorBlock","overscrollBehaviorInline","overscrollBehaviorX","overscrollBehaviorY","padding","paddingBlock","paddingBlockStart","paddingBlockEnd","paddingBottom","paddingInline","paddingInlineEnd","paddingInlineStart","paddingLeft","paddingRight","paddingTop","pageBreakAfter","pageBreakBefore","pageBreakInside","perspective","perspectiveOrigin","placeContent","placeItems","placeSelf","pointerEvents","position","printColorAdjust","quotes","resize","revert","right","rotate","scale","tabSize","tableLayout","textAlign","textAlignLast","textAlignUpright","textDecoration","textDecorationColor","textDecorationLine","textDecorationStyle","textDecorationThickness","textEmphasis","textEmphasisColor","textEmphasisPosition","textEmphasisStyle","textIndent","textJustify","textOrientation","textOverflow","textRendering","textShadow","textSizeAdjust","textTransform","textUnderlineOffset","textUnderlinePosition","top","touchAction","transform","transformBox","transformOrigin","transformStyle","transition","transitionDelay","transitionDuration","transitionProperty","transitionTimingFunction","unicodeBidi","verticalAlign","visibility","whiteSpace","widows","width","willChange","wordBreak","wordSpacing","wordWrap","writingMode","zIndex","-moz-appearance","-webkit-appearance"],cssToJsPropertyMappings:{float:"cssFloat"},mobile:screen.width<=480,browserVersion:function(){var e,t=navigator.userAgent,n=t.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(n[1])?"IE "+((e=/\brv[ :]+(\d+)/g.exec(t)||[])[1]||""):"Chrome"===n[1]&&null!=(e=t.match(/\bOPR\/(\d+)/))?"Opera "+e[1]:(n=n[2]?[n[1],n[2]]:[navigator.appName,navigator.appVersion,"-?"],null!=(e=t.match(/version\/(\d+)/i))&&n.splice(1,1,e[1]),n.join(" "))}}},function(e,t){e.exports=function(){var e=(new Date).getTime();return"xxxxxxxxxxxxxxxxx".replace(/x/g,(function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?n:3&n|8).toString(16)}))}},function(e,t){e.exports=function(e){return"string"==typeof e&&!!e.match(/^\s*\S+/)}},function(e,t){e.exports=function(e,t){return e[t]&&e[t].cdata||e[t]}},,function(e,t,n){"use strict";e.exports=function(e){return null!=e}},function(e,t){var n={getJSON:function(e,t,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};n.setupRequest(e,"GET",t,r,i).send()},postJSON:function(e,t,r,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};n.setupRequest(e,"POST",r,i,o).send(JSON.stringify(t))},setupRequest:function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},o=new XMLHttpRequest;for(var a in o.onreadystatechange=function(){if(4===this.readyState){var e=null;try{(e=JSON.parse(this.responseText)).status=this.status}catch(t){e={status:this.status,unparseable:!0,message:"Unable to parse the response."}}this.status<400?n(e):r(e)}},o.open(t,e,!0),o.setRequestHeader("Accept","application/json"),o.setRequestHeader("Content-Type","application/json"),o.setRequestHeader("Cache-Control","no-cache"),Object.keys(i))o.setRequestHeader(a,i[a]);return o}};e.exports=n},function(e,t){function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var r=function(){function e(t,n,r,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.count=1,this.max=t,this.delay=n,this.work=r,this.exceeded=i,this.timeoutId=null,this.running=!0,this.runNow=this.runNow.bind(this),this.runLater=this.runLater.bind(this),this.isRunning=this.isRunning.bind(this)}var t,r,i;return t=e,(r=[{key:"runNow",value:function(){return!(!this.running||(this.work(),this.count++,this.count>this.max&&(this.exceeded(),this.stop(),1)))}},{key:"runLater",value:function(){var e=this;return!!this.isRunning()&&(this.timeoutId=setTimeout((function(){return e.runNow()}),this.delay),!0)}},{key:"stop",value:function(){this.running=!1,this.timeoutId&&clearTimeout(this.timeoutId)}},{key:"isRunning",value:function(){return this.running}}])&&n(t.prototype,r),i&&n(t,i),e}();e.exports=r},function(e,t){function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var r=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,i;return t=e,i=[{key:"decode",value:function(e){if(e)try{return window.JSON.parse(window.atob(e))}catch(e){}return null}}],(r=null)&&n(t.prototype,r),i&&n(t,i),e}();e.exports=r},function(e,t){e.exports=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=null==e,i="".concat(t," is required");if(r&&n)console.warn(i);else if(r)throw i;return e}},function(e,t,n){function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var c=n(3),l=n(4),u=n(11),d=function(){function e(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:c();a(this,e),this.frameId=t,this.destination=n,this.contents=r,this.token=i}var t,n,r;return t=e,(n=[{key:"inject",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(document.getElementById(this.frameId))return!1;var t=document.getElementById(this.destination),n=document.createElement("iframe"),r=this.token;return e.show||(n.style.display="none"),e.classes&&(n.className=e.classes),n.src=e.src?e.src:"data:text/html;charset=utf-8,"+this.encodeContentsAndReceiverScript(),n.id=this.frameId,e.submit&&(n.onload=function(){n.contentWindow.postMessage(r,"*")}),t.appendChild(n),!0}},{key:"encodeContentsAndReceiverScript",value:function(){return encodeURI(this.contents+this.generateReceiverScript())}},{key:"generateReceiverScript",value:function(){return"\n    <script>\n      function messageHandler(event) {\n        if (event.data === '".concat(this.token,"' && document.forms && document.forms[0]) {\n          document.forms[0].submit()\n        }\n      }\n\n      if (window.addEventListener) {\n        window.addEventListener('message', messageHandler, false)\n      } else {\n        window.attachEvent('onmessage', messageHandler)\n      }\n    <\/script>\n    ")}}])&&s(t.prototype,n),r&&s(t,r),e}();e.exports={FrameManager:d,makeFrameManager:function(e){var t=e.frameManagerClass||d,n=e.frameId,r=e.destination,o=e.url,a=e.contents,s=e.injectOptions||{};u(n,"options.frameId"),u(o||a,"options.url or options.contents");var c=null,f=!1;return(l(o)||l(a))&&(c=new t(n,r,a),f=o?c.inject(i({submit:!1,src:o},s)):c.inject(i({submit:!0},s))),{success:f,frameManager:c}}}},,,,,,,,,,function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var i=n(2),o=n(23),a=n(24),s=n(43),c=n(46),l=n(47),u=n(0),d=n(61),f=function(e){return document.getElementById("spreedly-iframe")?document.getElementById("spreedly-iframe").getAttribute(e):null},h=function(e,t){return null===t||0===t.length?e:e+(e.indexOf("?")>=0?"&":"?")+t},p=function(e){return"express"===e?"client="+e:""};function m(){this.Utils=c,this.ThreeDS=l,this.init=function(e,t){this.isLoaded()&&this.unload(),t&&t.source&&(this.source=t.source),t&&t.numberEl?this.numberTarget=t.numberEl:this.numberTarget=f("data-number-id"),t&&t.cvvEl?this.cvvTarget=t.cvvEl:this.cvvTarget=f("data-cvv-id"),this.environmentKey=e||f("data-environment-key"),this.numberFrameId="spreedly-number-frame-"+this.uniqueId,this.cvvFrameId="spreedly-cvv-frame-"+this.uniqueId,this.addIframeElements()},this.addIframeElements=function(){var e=o('<iframe sandbox="allow-scripts allow-same-origin" frameborder="0" width="100%" height="100%" scrolling="no"></iframe>');e.id=this.numberFrameId,e.name=this.numberFrameId,e.setAttribute("src",h("https://core.spreedly.com/v1/embedded/number-frame-1.84.html",p(this.source))),document.getElementById(this.numberTarget).appendChild(e);var t=o('<iframe sandbox="allow-scripts allow-same-origin" frameborder="0" width="100%" height="100%" scrolling="no"></iframe>');t.id=this.cvvFrameId,t.name=this.cvvFrameId,t.setAttribute("src",h("https://core.spreedly.com/v1/embedded/cvv-frame-1.84.html",p(this.source))),document.getElementById(this.cvvTarget).appendChild(t)},this.stripeRadar=function(e,t){var n;return window.Stripe?(n=window.Stripe(e,{canCreateRadarSession:!0}))?void n.createRadarSession().then((function(e){var n;e.radarSession&&e.radarSession.id?n=e.radarSession.id:(e.error&&console.error("Spreedly: Creating a radar session failed. Reason: "+e.error.message),n=null),t(n)})):(console.error("Creating a Stripe session failed."),t(null),null):(console.error("Cannot find Stripe on page."),t(null),null)},this.createStripePaymentElement=function(e){if(!window.Stripe)return{error:"Cannot find Stripe on page."};if(!e.publishableKey)return{error:"Required input field 'publishableKey' was not supplied."};if(!e.clientSecret)return{error:"Required input field 'clientSecret' was not supplied."};if(!e.transactionToken)return{error:"Required input field 'transactionToken' was not supplied."};if(!e.paymentElement)return{error:"Required input field 'paymentElement' was not supplied."};var t=window.Stripe(e.publishableKey);if(!t)return{error:"Creating a Stripe session failed."};var n={clientSecret:e.clientSecret,appeareance:e.appeareance},r=e.spreedlyRoot||"https://core.spreedly.com",i={return_url:"".concat(r,"/transaction/").concat(e.transactionToken,"/redirect")},o=t.elements(n);return o.create("payment").mount(e.paymentElement),{confirmPayment:function(){return t.confirmPayment({elements:o,confirmParams:i})}}},this.createBraintreePaymentElements=function(e){var t,n,r,i,o=["callbackFunction","transactionToken","paymentElements","environmentKey"].filter((function(t){return Object.keys(e).indexOf(t)<0}));if(o.length>0)return{error:"Missing required parameter/s: ".concat(o)};var a=[];if(null!==(t=window.braintree)&&void 0!==t&&t.client||a.push("Client"),!e.paymentElements.paypal||null!==(n=window.braintree)&&void 0!==n&&n.paypalCheckout||a.push("Paypal Checkout"),!e.paymentElements.venmo||null!==(r=window.braintree)&&void 0!==r&&r.venmo||a.push("Venmo"),!e.paymentElements.venmo||null!==(i=window.braintree)&&void 0!==i&&i.dataCollector||a.push("Data Collector"),a.length>0)return{error:"The following Braintree scripts are not present on page: ".concat(a)};if("function"!=typeof e.callbackFunction)return{error:"Required parameter 'callbackFunction' is not a function."};var s=function(e){var t=new Date(e),n=new Date;if(Math.abs(t.getTime()-n.getTime())>=864e5)return{error:"The client token is no longer valid."}};"testToken"!=e.transactionToken&&u.withStatus(e.transactionToken,e.environmentKey,(function(t){var n={amount:t.transaction.amount/100,currencyCode:t.transaction.currency_code,clientToken:t.transaction.client_token,paymentMethodUsed:t.transaction.payment_method_type,paypalFlow:t.transaction.paypal_flow_type};if(!Object.keys(e.paymentElements).includes(n.paymentMethodUsed.toLowerCase()))return{error:"Cannot find payment element corresponding to payment method used during transaction."};s(t.transaction.created_at),d.initializeBraintreeButtons(e,n)}),(function(){return{error:"An error occured while obtaining required information from transactionToken."}}))},this.checkUniqueId=function(e){return e===this.uniqueId},this.on=function(e,t){this.emitter.on(e,t)},this.emit=function(e,t,n,r,i){this.emitter.emit(e,t,n,r,i)},this.isLoaded=function(){return!(!this.numberFrameId&&!this.cvvFrameId)&&!(!document.getElementById(this.numberFrameId)&&!document.getElementById(this.cvvFrameId))},this.reload=function(){this.unload();var e={numberEl:this.numberTarget,cvvEl:this.cvvTarget};this.init(this.environmentKey,e)},this.removeHandlers=function(){s(this.emitter)},this.resetFields=function(){this.sendMessage("reset")},this.sendMessage=function(e){document.getElementById(this.numberFrameId).contentWindow.postMessage(e,"https://core.spreedly.com")},this.setValue=function(e,t){"cvv"===e?this.sendMessage("setCvv: "+t):"number"===e&&this.sendMessage("setNumber: "+t)},this.setLabel=function(e,t){"cvv"===e?this.sendMessage("setCvvLabel: "+t):"number"===e&&this.sendMessage("setNumberLabel: "+t)},this.setTitle=function(e,t){"cvv"===e?this.sendMessage("setCvvTitle: "+t):"number"===e&&this.sendMessage("setNumberTitle: "+t)},this.setInputMode=function(e,t){"cvv"===e?this.sendMessage("setCvvInputMode: "+t):"number"===e&&this.sendMessage("setNumberInputMode: "+t)},this.setFieldType=function(e,t){t||(t=e,e="number"),"cvv"===e?this.sendMessage("setCvvType: "+t):"number"===e&&this.sendMessage("setNumberType: "+t)},this.setNumberFormat=function(e){this.sendMessage("numberFormat: "+e)},this.toggleAutoComplete=function(){this.sendMessage("autoComplete")},this.toggleMask=function(){this.sendMessage("toggleMask")},this.setPlaceholder=function(e,t){this.sendMessage("placeholder: "+e+":"+t)},this.setParam=function(e,t){"object"===r(t)&&null!==t&&(t=JSON.stringify(t)),this.sendMessage("param("+e+"): "+t)},this.setStyle=function(e,t){this.sendMessage("style("+e+"): "+t)},this.setRecache=function(e,t){this.sendMessage("setRecache: "+e),this.setParam("environment_key",this.environmentKey),t&&t.last_four_digits&&this.setParam("last_four_digits",t.last_four_digits),t&&t.card_type&&this.setParam("card_type",t.card_type)},this.recache=function(){this.sendMessage("recache")},this.tokenizeCreditCard=function(e){if(e){this.setParam("environment_key",this.environmentKey);for(var t=0;t<v.length;t++)e[v[t]]&&this.setParam(v[t],e[v[t]])}return this.sendMessage("getToken"),!1},this.transferFocus=function(e){this.sendMessage("focus: "+e)},this.unload=function(){var e=document.getElementById(this.numberFrameId);e&&e.parentNode.removeChild(e);var t=document.getElementById(this.cvvFrameId);t&&t.parentNode.removeChild(t)},this.validate=function(){this.sendMessage("validate")},this.buildMessageHandler=function(){var e=this;return function(t){if(("string"==typeof t.data||t.data instanceof String)&&"https://core.spreedly.com"===t.origin&&e.checkUniqueId(t.data.substring(0,4))&&e.isLoaded()){var n,r=t.data.substring(4);if("frameLoaded:"===r);else if("iframesReady"===r)e.source&&e.sendMessage("source: "+e.source),e.emit("ready");else if("recacheReady"===r)e.emit("recacheReady");else if(n=r.match(/paymentMethod\((.*)\): (.*)/i))e.emit("paymentMethod",n[1],JSON.parse(n[2]));else if(n=r.match(/recacheResult\((.*)\): (.*)/i))e.emit("recache",n[1],JSON.parse(n[2]));else if(n=r.match(/errors: (.*)/i))e.emit("errors",JSON.parse(n[1]));else if(n=r.match(/validation: (.*)/i))e.emit("validation",JSON.parse(n[1]));else if(n=r.match(/input: (.*)/i)){var i=JSON.parse(n[1]),o=i.activeElement;e.emit("fieldEvent",o,"input",o,i)}else(n=r.match(/notifyEvent\( (.*)\): (.*):(.*)/i))?e.emit("fieldEvent",n[1],n[2],n[3],{}):(n=r.match(/consoleError: (.*)/i))?e.emit("consoleError",JSON.parse(n[1])):"numberSet"===r?e.emit("numberSet"):"cvvSet"===r?e.emit("cvvSet"):(n=r.match(/sourceSet: (.*)/i))&&e.emit("sourceSet",n[1])}}},this.uniqueId=(Math.floor(8999*Math.random())+1e3).toString(),this.messageHandler=this.buildMessageHandler(),i.addListener(window,"message",this.messageHandler),this.emitter=new a}var g=new m;e.exports=g,window.Spreedly=g,window.SpreedlyPaymentFrame=m;var v=["first_name","last_name","full_name","email","month","year","address1","address2","city","state","zip","country","phone_number","company","shipping_address1","shipping_address2","shipping_city","shipping_state","shipping_zip","shipping_country","shipping_phone_number","metadata"]},function(e,t){e.exports=function(e,t){if("string"!=typeof e)throw new TypeError("String expected");t||(t=document);var n=/<([\w:]+)/.exec(e);if(!n)return t.createTextNode(e);e=e.replace(/^\s+|\s+$/g,"");var r=n[1];if("body"==r){return(o=t.createElement("html")).innerHTML=e,o.removeChild(o.lastChild)}var o,a=Object.prototype.hasOwnProperty.call(i,r)?i[r]:i._default,s=a[0],c=a[1],l=a[2];(o=t.createElement("div")).innerHTML=c+e+l;for(;s--;)o=o.lastChild;if(o.firstChild==o.lastChild)return o.removeChild(o.firstChild);var u=t.createDocumentFragment();for(;o.firstChild;)u.appendChild(o.removeChild(o.firstChild));return u};var n,r=!1;"undefined"!=typeof document&&((n=document.createElement("div")).innerHTML='  <link/><table></table><a href="/a">a</a><input type="checkbox"/>',r=!n.getElementsByTagName("link").length,n=void 0);var i={legend:[1,"<fieldset>","</fieldset>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],_default:r?[1,"X<div>","</div>"]:[0,"",""]};i.td=i.th=[3,"<table><tbody><tr>","</tr></tbody></table>"],i.option=i.optgroup=[1,'<select multiple="multiple">',"</select>"],i.thead=i.tbody=i.colgroup=i.caption=i.tfoot=[1,"<table>","</table>"],i.polyline=i.ellipse=i.polygon=i.circle=i.text=i.line=i.path=i.rect=i.g=[1,'<svg xmlns="http://www.w3.org/2000/svg" version="1.1">',"</svg>"]},function(e,t,n){"use strict";var r,i,o,a,s,c,l,u=n(25),d=n(42),f=Function.prototype.apply,h=Function.prototype.call,p=Object.create,m=Object.defineProperty,g=Object.defineProperties,v=Object.prototype.hasOwnProperty,y={configurable:!0,enumerable:!1,writable:!0};i=function(e,t){var n,i;return d(t),i=this,r.call(this,e,n=function(){o.call(i,e,n),f.call(t,this,arguments)}),n.__eeOnceListener__=t,this},s={on:r=function(e,t){var n;return d(t),v.call(this,"__ee__")?n=this.__ee__:(n=y.value=p(null),m(this,"__ee__",y),y.value=null),n[e]?"object"==typeof n[e]?n[e].push(t):n[e]=[n[e],t]:n[e]=t,this},once:i,off:o=function(e,t){var n,r,i,o;if(d(t),!v.call(this,"__ee__"))return this;if(!(n=this.__ee__)[e])return this;if("object"==typeof(r=n[e]))for(o=0;i=r[o];++o)i!==t&&i.__eeOnceListener__!==t||(2===r.length?n[e]=r[o?0:1]:r.splice(o,1));else r!==t&&r.__eeOnceListener__!==t||delete n[e];return this},emit:a=function(e){var t,n,r,i,o;if(v.call(this,"__ee__")&&(i=this.__ee__[e]))if("object"==typeof i){for(n=arguments.length,o=new Array(n-1),t=1;t<n;++t)o[t-1]=arguments[t];for(i=i.slice(),t=0;r=i[t];++t)f.call(r,this,o)}else switch(arguments.length){case 1:h.call(i,this);break;case 2:h.call(i,this,arguments[1]);break;case 3:h.call(i,this,arguments[1],arguments[2]);break;default:for(n=arguments.length,o=new Array(n-1),t=1;t<n;++t)o[t-1]=arguments[t];f.call(i,this,o)}}},c={on:u(r),once:u(i),off:u(o),emit:u(a)},l=g({},c),e.exports=t=function(e){return null==e?p(l):g(Object(e),c)},t.methods=s},function(e,t,n){"use strict";var r=n(7),i=n(26),o=n(30),a=n(38),s=n(39);(e.exports=function(e,t){var n,i,c,l,u;return arguments.length<2||"string"!=typeof e?(l=t,t=e,e=null):l=arguments[2],r(e)?(n=s.call(e,"c"),i=s.call(e,"e"),c=s.call(e,"w")):(n=c=!0,i=!1),u={value:t,configurable:n,enumerable:i,writable:c},l?o(a(l),u):u}).gs=function(e,t,n){var c,l,u,d;return"string"!=typeof e?(u=n,n=t,t=e,e=null):u=arguments[3],r(t)?i(t)?r(n)?i(n)||(u=n,n=void 0):n=void 0:(u=t,t=n=void 0):t=void 0,r(e)?(c=s.call(e,"c"),l=s.call(e,"e")):(c=!0,l=!1),d={get:t,set:n,configurable:c,enumerable:l},u?o(a(u),d):d}},function(e,t,n){"use strict";var r=n(27),i=/^\s*class[\s{/}]/,o=Function.prototype.toString;e.exports=function(e){return!!r(e)&&!i.test(o.call(e))}},function(e,t,n){"use strict";var r=n(28);e.exports=function(e){if("function"!=typeof e)return!1;if(!hasOwnProperty.call(e,"length"))return!1;try{if("number"!=typeof e.length)return!1;if("function"!=typeof e.call)return!1;if("function"!=typeof e.apply)return!1}catch(e){return!1}return!r(e)}},function(e,t,n){"use strict";var r=n(29);e.exports=function(e){if(!r(e))return!1;try{return!!e.constructor&&e.constructor.prototype===e}catch(e){return!1}}},function(e,t,n){"use strict";var r=n(7),i={object:!0,function:!0,undefined:!0};e.exports=function(e){return!!r(e)&&hasOwnProperty.call(i,typeof e)}},function(e,t,n){"use strict";e.exports=n(31)()?Object.assign:n(32)},function(e,t,n){"use strict";e.exports=function(){var e,t=Object.assign;return"function"==typeof t&&(t(e={foo:"raz"},{bar:"dwa"},{trzy:"trzy"}),e.foo+e.bar+e.trzy==="razdwatrzy")}},function(e,t,n){"use strict";var r=n(33),i=n(37),o=Math.max;e.exports=function(e,t){var n,a,s,c=o(arguments.length,2);for(e=Object(i(e)),s=function(r){try{e[r]=t[r]}catch(e){n||(n=e)}},a=1;a<c;++a)r(t=arguments[a]).forEach(s);if(void 0!==n)throw n;return e}},function(e,t,n){"use strict";e.exports=n(34)()?Object.keys:n(35)},function(e,t,n){"use strict";e.exports=function(){try{return Object.keys("primitive"),!0}catch(e){return!1}}},function(e,t,n){"use strict";var r=n(1),i=Object.keys;e.exports=function(e){return i(r(e)?Object(e):e)}},function(e,t,n){"use strict";e.exports=function(){}},function(e,t,n){"use strict";var r=n(1);e.exports=function(e){if(!r(e))throw new TypeError("Cannot use null or undefined");return e}},function(e,t,n){"use strict";var r=n(1),i=Array.prototype.forEach,o=Object.create,a=function(e,t){var n;for(n in e)t[n]=e[n]};e.exports=function(e){var t=o(null);return i.call(arguments,(function(e){r(e)&&a(Object(e),t)})),t}},function(e,t,n){"use strict";e.exports=n(40)()?String.prototype.contains:n(41)},function(e,t,n){"use strict";var r="razdwatrzy";e.exports=function(){return"function"==typeof r.contains&&(!0===r.contains("dwa")&&!1===r.contains("foo"))}},function(e,t,n){"use strict";var r=String.prototype.indexOf;e.exports=function(e){return r.call(this,e,arguments[1])>-1}},function(e,t,n){"use strict";e.exports=function(e){if("function"!=typeof e)throw new TypeError(e+" is not a function");return e}},function(e,t,n){"use strict";var r=n(44),i=Object.prototype.hasOwnProperty;e.exports=function(e){var t,n=arguments[1];if(r(e),void 0===n)i.call(e,"__ee__")&&delete e.__ee__;else{if(!(t=i.call(e,"__ee__")&&e.__ee__))return;t[n]&&delete t[n]}}},function(e,t,n){"use strict";var r=n(45);e.exports=function(e){if(!r(e))throw new TypeError(e+" is not an Object");return e}},function(e,t,n){"use strict";var r=n(1),i={function:!0,object:!0};e.exports=function(e){return r(e)&&i[typeof e]||!1}},function(e,t,n){var r=n(8),i=n(9),o=n(3);e.exports={Request:r,Retryable:i,tokenGenerator:o}},function(e,t,n){var r=n(48),i=n(49);e.exports={Lifecycle:i,serialize:r.serialize}},function(e,t){function n(e){return function(t){var n=t||window;return n.screen&&n.screen[e]||null}}function r(e){return function(t){var n=t||window;return n.navigator&&n.navigator[e]||null}}function i(){return(new Date).getTimezoneOffset()}function o(e){var t=e||window;return t.navigator&&t.navigator.javaEnabled?t.navigator.javaEnabled():null}var a=n("width"),s=n("height"),c=n("colorDepth"),l=r("userAgent"),u=r("language");e.exports={width:a,height:s,depth:c,timezone:i,userAgent:l,java:o,language:u,serialize:function(e,t,n){var r=n||window;return btoa(JSON.stringify(function(e,t,n){var r=n||window;return{width:a(r),height:s(r),depth:c(r),timezone:i(),user_agent:l(r),java:o(r),language:u(r),browser_size:e,accept_header:t||"text/html,application/xhtml+xml,application/xml"}}(e,t,r)))}}},function(e,t,n){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var o=n(0),a=n(11),s=n(50),c=n(52),l=n(54),u=n(55),d=n(57),f=n(58),h=n(59),p=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r(this,e),this.hiddenIframeLocation=a(t.hiddenIframeLocation,"hiddenIframeLocation option"),this.transactionToken=a(t.transactionToken,"transactionToken option"),this.challengeIframeLocation=a(t.challengeIframeLocation,"challengeIframeLocation option"),this.challengeIframeClasses=t.challengeIframeClasses,this.environmentKey=a(t.environmentKey,"environmentKey option",!0),this.Redirect=t.Redirect||u,this.Challenge=t.Challenge||h,this.DeviceFingerprint=t.DeviceFingerprint||f,this.start=this.start.bind(this),this.poll=this.poll.bind(this),this.stopPolling=this.stopPolling.bind(this),this.finalize=this.finalize.bind(this),this.event=this.event.bind(this),this.error=this.error.bind(this),this.installPoller=this.installPoller.bind(this),this.poller=t.poller,this.statusManager=t.statusManager||new c,this.eventPublisher=new s(this.finalize,this.transactionToken,this.statusManager,t.notifier||window.Spreedly),this.StatusPolling=t.StatusPolling||o,this.deviceFingerprintTimeoutTask=t.deviceFingerprintTimeoutTask||new l(10,"device-fingerprint",this.eventPublisher)}var t,n,p;return t=e,(n=[{key:"installExtensions",value:function(e){"braintree"===e.gateway_type&&(this.DeviceFingerprint=d)}},{key:"start",value:function(){var e=this;this.StatusPolling.withContext(this.transactionToken,this.environmentKey,(function(t){e.installExtensions(t),e.handleUpdate("start",t)}))}},{key:"poll",value:function(e){return this.handleUpdate("polling",e)}},{key:"stopPolling",value:function(){this.poller&&this.poller.stop()}},{key:"installPoller",value:function(e){if(!e)return!1;this.stopPolling(),this.poller=e,this.poller.run()}},{key:"finalize",value:function(e){if(!this.statusManager.recordOnChange("finalize",{state:"finalize"}))return"noop";this.Challenge.run(e,this.transactionToken,this.environmentKey,this.challengeIframeLocation,this.challengeIframeClasses,this.poll,this.finalize,this.installPoller,this.eventPublisher)}},{key:"handleUpdate",value:function(e,t){if(!this.statusManager.recordOnChange(e,t))return"noop";switch("".concat(t.state," & ").concat(t.required_action)){case"pending & redirect":case"pending & fallback":return this.Redirect.run(this,t,this.hiddenIframeLocation),"redirect";case"pending & challenge":return"start"!==e&&"polling"!==e||this.finalize(t),"challenge";case"pending & device_fingerprint":return this.DeviceFingerprint.run(t,this.transactionToken,this.environmentKey,this.hiddenIframeLocation,this.finalize,this.poll,this.installPoller,this.eventPublisher,this.deviceFingerprintTimeoutTask),"device_fingerprint"}return"succeeded"===t.state?(this.stopPolling(),this.event("handleEvent","succeeded",t),"succeeded"):"failed"===t.state||"gateway_processing_failed"===t.state||"gateway_setup_failed"===t.state?(this.stopPolling(),this.error("handleUpdate","Failed to process transaction",t),"failed"):void 0}},{key:"error",value:function(e,t){this.stopPolling(),this.eventPublisher.error(e,t)}},{key:"event",value:function(e,t,n){return this.eventPublisher.event(e,t,n)}}])&&i(t.prototype,n),p&&i(t,p),e}();e.exports=p},function(e,t,n){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i=n(51),o=function(){function e(t,n,r,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.finalize=t,this.transactionToken=n,this.statusManager=r,this.event=this.event.bind(this),this.error=this.error.bind(this),this.notifier=i||window.Spreedly}var t,n,o;return t=e,(n=[{key:"event",value:function(e,t,n){return!!this.statusManager.recordOnChange(e,t,i)&&this.notifier.emit("3ds:status",{action:t,context:n,token:this.transactionToken,finalize:this.finalize})}},{key:"error",value:function(e,t){return this.event(e,"error",t)}}])&&r(t.prototype,n),o&&r(t,o),e}();e.exports=o},function(e,t){function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var r=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.initiator=t,this.index=n,this.action=r}var t,r,i;return t=e,(r=[{key:"getInitiator",value:function(){return this.initiator}},{key:"getIndex",value:function(){return this.index}},{key:"getType",value:function(){return"EventStatus"}},{key:"getAction",value:function(){return this.action}},{key:"diff",value:function(e){return e.getType()!==this.getType()||e.getAction()!==this.action}},{key:"toString",value:function(){return["Type:            ".concat(this.getType()),"Initiator:       ".concat(this.initiator),"Index:           ".concat(this.index),"Action:          ".concat(this.action)].join("\n")}}])&&n(t.prototype,r),i&&n(t,i),e}();e.exports=r},function(e,t,n){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i=n(53),o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.statuses=[new i]}var t,n,o;return t=e,(n=[{key:"getCurrentStatus",value:function(){return this.statuses[this.statuses.length-1]}},{key:"recordOnChange",value:function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:i,r=new n(e,this.statuses.length,t),o=0;o<this.statuses.length;o++){var a=this.statuses[o];if(!a.diff(r))return!1}return this.statuses.push(r),!0}}])&&r(t.prototype,n),o&&r(t,o),e}();e.exports=o},function(e,t){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};n(this,e),this.initiator=t||"unknown",this.index=r||0,this.state=i.state||"unknown",this.requiredAction=i.required_action||"unknown"}var t,i,o;return t=e,(i=[{key:"getInitiator",value:function(){return this.initiator}},{key:"getIndex",value:function(){return this.index}},{key:"getRequiredAction",value:function(){return this.requiredAction}},{key:"getState",value:function(){return this.state}},{key:"getType",value:function(){return"Status"}},{key:"diff",value:function(e){return e.getType()!==this.getType()||e.getState()!==this.state||e.getRequiredAction()!==this.requiredAction}},{key:"toString",value:function(){return["Type:            ".concat(this.getType()),"Initiator:       ".concat(this.initiator),"Index:           ".concat(this.index),"State:           ".concat(this.state),"Required Action: ".concat(this.requiredAction)].join("\n")}}])&&r(t.prototype,i),o&&r(t,o),e}();e.exports=i},function(e,t){function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var r=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.timeInSeconds=t,this.context=n,this.eventPublisher=r}var t,r,i;return t=e,(r=[{key:"start",value:function(e){this.eventPublisher.event("CancelableTask","".concat(this.context,"#start"),this),this.task=setTimeout(e,1e3*this.timeInSeconds)}},{key:"stop",value:function(){this.eventPublisher.event("CancelableTask","".concat(this.context,"#stop"),this),this.task&&clearTimeout(this.task)}}])&&n(t.prototype,r),i&&n(t,i),e}();e.exports=r},function(e,t,n){var r=n(56);e.exports={run:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:r;i(t,n)?e.event("Redirect.run","fallback",t):e.error("Redirect.run","fallback",t)}}},function(e,t,n){var r=n(4),i=n(5);e.exports=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window;if(!r(t))throw"A DOM id is required for injecting the 3DS 1 fallback";var o=i(e,"checkout_form");if(r(o)&&!/action\=\"\"/.test(o)){n.document.getElementById(t).innerHTML=o;var a=n.document.getElementById(t).getElementsByTagName("form");if(a.length>0)return a[0].submit(),!0}else if(r(e.checkout_url))return n.location=e.checkout_url,!0;return!1}},function(e,t,n){function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var s=n(10),c=n(0),l=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"run",value:function(e,t,n,r,o,a,l,u,d,f,h,p,m){var g=p||braintree,v=m||s,y=new(h||c)(t,a,(function(e){u.error("Braintree 3DS timeout",e),a(e)}),n,200);u.event("Braintree Integration","device-fingerprint",e);var b=v.decode(e&&e.three_ds_context),w=i(i({},b.threeDSecureParameters),{},{onLookupComplete:function(e,t){t()}});g.client.create({authorization:b.clientToken},(function(e,t){if(e)return y.stop(),void u.error("Braintree client error",{originalError:e});g.threeDSecure.create({version:2,client:t},(function(e,t){if(e)return y.stop(),void u.error("Braintree 3DS Client error",{originalError:e});t.verifyCard(w,(function(e,t){if(e)return y.stop(),void u.error("Braintree 3DS Authentication error",{originalError:e});u.event("Braintree 3DS Integration","trigger-completion",{payment_method_nonce:t.nonce})}))}))})),l(y)}}],(n=null)&&a(t.prototype,n),r&&a(t,r),e}();e.exports=l},function(e,t,n){function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var a=n(5),s=n(0),c=n(12).makeFrameManager;e.exports={run:function(e,t,n,r,o,l,u,d,f,h,p){var m=p||s,g=(h||c)({frameId:"challenge-flow",destination:r,url:e.device_fingerprint_form_embed_url,contents:a(e,"device_fingerprint_form")}),v=g.success,y=g.frameManager;if(v&&y){var b=new m(t,l,(function(t){var n=i(i({},e),t);d.event("DeviceFingerprint polling","trigger-completion",n),l(n)}),n,20);"worldpay"===e.gateway_type?(f.start((function(){return d.error("deviceFingerprintTimeoutTask#start",e)})),window.addEventListener("message",(function(e){!function(e,t,n){var r=null;try{r=JSON.parse(e.data)}catch(t){r=e.data}r&&"profile.completed"===r.MessageType&&(n.stop(),t.event("sendPostMessageWhenTrusted","trigger-completion",r))}(e,d,f)}),!1)):d.event("DeviceFingerprint.run","device-fingerprint",e),u(b)}else d.error("DeviceFingerprint.run",i({step:"device-fingerprint"},e)),u(null)}}},function(e,t,n){function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var a=n(60),s=n(0);e.exports={run:function(e,t,n,r,o,c,l,u,d,f,h){var p=f||s,m=h||a,g=null;"pending"!==e.state||"challenge"!==e.required_action?d.error("Challenge.run",{state:e,errors:["Failed to finalize. The transaction is not in the correct state. State should be 'pending' and required action should be 'challenge'"]}):m(e,r,o)?(d.event("Challenge.run","challenge",e),g=new p(t,(function(t){return c(i(i({},e),t))}),(function(){return d.event("Challenge polling","finalization-timeout")}),n,1200)):d.error("Challenge.run",{state:e,errors:["Failed to inject the challenge iframe, is the challengeIframeLocation valid?"]});u(g)}}},function(e,t,n){function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var a=n(4),s=n(5),c=n(12).makeFrameManager,l=n(3);e.exports=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:l;if(!t)throw"A DOM id is required for injecting the challenge form.";var u=s(e,"challenge_form"),d=e.challenge_form_embed_url,f={frameId:"challenge-iframe-".concat(o()),frameManagerClass:r,destination:t,injectOptions:{show:!0,classes:n}},h=null;if(a(d))h=c(i({url:d},f)).frameManager;else if(a(u))h=c(i({contents:u},f)).frameManager;else{if(!a(e.challenge_url))throw"challenge_form and challenge_url are missing. Ensure that one of them is included.";h=c(i({url:e.challenge_url},f)).frameManager}return h}},function(e,t){function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var r=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,i;return t=e,i=[{key:"initializeBraintreeButtons",value:function(t,n){braintree.client.create({authorization:n.clientToken},(function(r,i){if(r)return{error:"Error creating client: ".concat(r)};t.paymentElements.paypal&&e.paypalButton(t,i,n),t.paymentElements.venmo&&e.venmoButton(t,i,n)}))}},{key:"createPaymentMethodParams",value:function(e){var t={flow:"vault"==e.paypalFlow?"vault":"checkout",amount:e.amount,currency:e.currencyCode,intent:"capture"};return"checkout with vault"==e.paypalFlow&&(t.requestBillingAgreement=!0),t}},{key:"paypalButton",value:function(t,n,r){braintree.paypalCheckout.create({client:n},(function(n,i){if(n)return{error:"Error creating PayPal Checkout component: ".concat(n)};var o={transaction:{payment_method:{payment_method_type:"paypal"}}};i.loadPayPalSDK({currency:r.currencyCode,intent:"capture"},(function(){paypal.Buttons({fundingSource:paypal.FUNDING.PAYPAL,createOrder:function(){return i.createPayment(e.createPaymentMethodParams(r))},onApprove:function(e){return i.tokenizePayment(e,(function(e,n){t.callbackFunction({state:"Successful",nonce:n.nonce,payment_method:o})}))},onCancel:function(e){t.callbackFunction({state:"Cancelled",message:"PayPal payment cancelled, ".concat(JSON.stringify(e,null,2)),payment_method:o})},onError:function(e){t.callbackFunction({state:"Failed",message:e,payment_method:o})}}).render("#".concat(t.paymentElements.paypal))}))}))}},{key:"venmoButton",value:function(e,t){var n;function r(t,n){e.callbackFunction({state:"Cancelled",message:"VENMO_CANCELED"===t.code?"App is not available or user aborted payment flow":"User canceled payment flow",payment_method:n})}function i(t,n){e.callbackFunction({state:"Failed",message:"An error occurred: ".concat(t.message),payment_method:n})}function o(t,r){e.callbackFunction({state:"Successful",nonce:t.nonce,payment_method:r,device_data:n})}braintree.dataCollector.create({client:t,paypal:!0},(function(e,t){if(e)return{error:"Error occured in the creation of data collector: ".concat(e)};n=t.deviceData})),braintree.venmo.create({client:t,allowDesktop:!0,paymentMethodUsage:"multi_use"},(function(t,n){if(t)return{error:"Error creating Venmo: ".concat(t)};if(!n.isBrowserSupported())return{error:"Browser does not support Venmo"};var a={transaction:{payment_method:{payment_method_type:"venmo"}}};!function(t,n){var a=document.getElementById(e.paymentElements.venmo);a.style.display="block",a.addEventListener("click",(function(){a.disabled=!0,t.tokenize((function(e,t){a.removeAttribute("disabled"),e?"VENMO_CANCELED"===e.code||"VENMO_APP_CANCELED"===e.code||"VENMO_DESKTOP_CANCELED"===e.code?r(e,n):i(e,n):o(t,n)}))}))}(n,a),n.hasTokenizationResult()&&n.tokenize((function(e,t){e?"VENMO_CANCELED"===e.code||"VENMO_APP_CANCELED"===e.code?r(e,a):i(e,a):o(t,a)}))}))}}],(r=null)&&n(t.prototype,r),i&&n(t,i),e}();e.exports=r}]);