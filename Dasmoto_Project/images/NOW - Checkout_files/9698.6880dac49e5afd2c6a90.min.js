"use strict";(self.webpackChunkott_sas_eu_checkout=self.webpackChunkott_sas_eu_checkout||[]).push([[9698],{69698:(e,t,r)=>{r.d(t,{rX:()=>$,nH:()=>K,OM:()=>P,cf:()=>d.cf,TZ:()=>ae,GG:()=>le,I6:()=>V,au:()=>J,QX:()=>de,Ig:()=>oe,UW:()=>se});var a=r(67294),n=(r(45697),r(14890)),i=r(28216),o=r(94184),s=r.n(o),d=r(46866);const l="paymentIframe/CARD_DETAILS_SAVED",c="paymentIframe/CLIENT_VALIDATION_ERROR",u="paymentIframe/PAYMENT_IFRAME_ERROR",p="paymentIframe/PAYMENT_IFRAME_TIMED_OUT",m="paymentIframe/POST_MESSAGE",h="paymentIframe/POST_MESSAGE_SENT",f="paymentIframe/REFRESH",y="paymentIframe/REFRESHED",E="paymentIframe/REQUIRES_3D_SECURE",S="paymentIframe/SAVE_CARD_DETAILS",v="paymentIframe/SET_MPP_SESSION",g="paymentIframe/THREED_SECURE_IFRAME_ERROR",w="paymentIframe/THREED_SECURE_IFRAME_TIMED_OUT";function I(e){return{type:v,payload:e}}function T(e){return{type:S,payload:e}}function _(e){return{type:m,message:e}}function C(){return{type:h}}function b(){return{type:f}}function L(){return{type:y}}function A(){return{type:l}}function R(e){return{type:c,payload:e}}function D(){return{type:p}}function M(e){return{type:u,payload:e}}function N(){return{type:E}}function k(e){return{type:w,payload:e}}function O(e){return{type:g,payload:e}}class H extends a.Component{constructor(){super(),this.state={loading:!0,iframeHeight:void 0},this.handleIframeLoad=this.handleIframeLoad.bind(this),this.iframeHeightWatcher=this.iframeHeightWatcher.bind(this),this.resizeIframeInterval=void 0}componentDidMount(){this.client=(0,d.wV)(this.refs.paymentIframe,{id:this.props.paymentIframeConfig.id||"payment-iframe",onLoad:this.onLoadHandler.bind(this),onCardDetailsSaved:this.onCardDetailsSavedHandler.bind(this),onError:this.onErrorHandler.bind(this),onValidationFailed:this.onValidationFailedHandler.bind(this),onPaymentIframeResize:this.onPaymentIframeResizeHandler.bind(this),timeout:this.props.paymentIframeConfig.timeout,onMessage:this.props.handlePaymentIframeMessage,onLoadTimeout:()=>{this.props.actions.paymentIframeTimedOut()},on3dSecureRequired:()=>{this.props.actions.requires3dSecure(),this.props.handle3dSecureRequired()},on3dSecureSuccess:e=>{e&&e.paymentToken&&this.props.handle3dSecureSuccess(e),this.setLoading(!0)},on3dSecureFailed:()=>{this.refs.paymentIframe.setAttribute("src",this.props.paymentIframeConfig.url),this.props.handle3dSecureFailure()},on3dSecureCancelled:()=>{this.refs.paymentIframe.setAttribute("src",this.props.paymentIframeConfig.url),this.props.handle3dSecureCancel()}})}componentWillReceiveProps(e){if(e.savingCardDetails&&e.savingCardDetails!==this.props.savingCardDetails){let t={amountToPay:e.amountToPay};e.mppSession&&(t.mppSession=e.mppSession),e.extraDetails&&(t=e.extraDetails),this.client.saveCardDetails(t)}e.requires3dSecure&&e.requires3dSecure!==this.props.requires3dSecure&&!this.state.loading&&(this.client.sendTo3dSecure(),this.refs.paymentIframe.setAttribute("style","height: 800px")),e.refresh&&(this.setLoading(!0),this.refs.paymentIframe.setAttribute("src",this.props.paymentIframeConfig.url),e.actions.onRefreshed()),e.postMessageBody&&e.postingMessage&&!this.props.postingMessage&&(this.client.postMessage(e.postMessageBody),this.props.actions.messagePosted())}componentDidUpdate(){this.client.resize()}componentWillUnmount(){this.client.unmount(),this.killIframeHeightWatcher()}onCardDetailsSavedHandler(e){this.props.actions.cardDetailsSaved(),this.props.handleCardDetailsSaved(e)}onErrorHandler(e){this.props.handleError&&this.props.handleError(e),this.props.actions.paymentIframeError(e)}onPaymentIframeResizeHandler(e){this.refs.paymentIframe.setAttribute("style",`height: ${e.height}px`)}onLoadHandler(){this.setLoading(!1)}onValidationFailedHandler(e){this.props.handleValidationFailed(e),this.props.actions.clientValidationError(e)}setLoading(e){this.setState({loading:e})}handleIframeLoad(){this.spawnIframeHeightWatcher()}iframeHeightWatcher(){this.client.resize();const e=this.client&&this.client.element&&this.client.element.clientHeight,t=0!==this.state.iframeHeight;e&&t&&(this.setState({iframeHeight:this.client.element.clientHeight,loading:!1}),this.killIframeHeightWatcher())}killIframeHeightWatcher(){window.clearInterval(this.resizeIframeInterval),this.resizeIframeInterval=void 0}spawnIframeHeightWatcher(){this.iframeHeightWatcher(),this.resizeIframeInterval=window.setInterval(this.iframeHeightWatcher,200)}render(){const e=(e=>{const t={};if(!e)return t;const{loading:r,iframeHeight:a}=e;return r&&(t.height=a),t})(this.state),t=s()("payment-iframe-loading",{hidden:!this.state.loading}),r=s()("payment-iframe",{hidden:this.state.loading});return a.createElement("div",null,a.createElement("div",{className:t},this.props.loadingComponent),a.createElement("div",{style:e},a.createElement("iframe",{id:"payment-iframe",frameBorder:"0",scrolling:"no",marginHeight:"0",marginWidth:"0",ref:"paymentIframe",className:r,src:this.props.paymentIframeConfig.url,onLoad:this.handleIframeLoad,title:"Your Payment Details"})))}}(0,i.connect)((e=>e.paymentIframe),(e=>({actions:(0,n.bindActionCreators)({setMppSession:I,saveCardDetails:T,postMessage:_,messagePosted:C,refresh:b,onRefreshed:L,cardDetailsSaved:A,clientValidationError:R,paymentIframeTimedOut:D,paymentIframeError:M,requires3dSecure:N},e)})))(H);class F extends a.Component{constructor(){super(),this.state={loading:!0}}componentDidMount(){this.client=(0,d.wV)(this.refs.threeDSecureIframe,{id:this.props.threeDSecureIframeConfig.id||"threedsecure-iframe",timeout:this.props.threeDSecureIframeConfig.timeout,onLoad:this.onLoadHandler.bind(this),onError:this.onErrorHandler.bind(this),onMessage:this.props.handle3dSecureIframeMessage,onLoadTimeout:()=>{this.props.actions.threeDSecureIframeTimedOut()},on3dSecureSuccess:({md:e,paResponse:t,transactionToken:r}={})=>{const a=void 0!==e&&void 0!==t;void 0!==r?this.setLoading(!0,(()=>{this.props.handle3dSecureSuccess({transactionToken:r,...a&&{md:e,paResponse:t}})})):a?this.setLoading(!0,(()=>{this.props.handle3dSecureSuccess({md:e,paResponse:t})})):this.props.handle3dSecureFailure()},on3dSecureFailed:()=>{this.props.handle3dSecureFailure()},on3dSecureCancelled:()=>{this.props.handle3dSecureCancel()}})}componentWillUnmount(){this.client.unmount()}onErrorHandler(e){this.props.handleError&&this.props.handleError(e),this.props.actions.threeDSecureIframeError(e)}onLoadHandler(){this.setLoading(!1)}setLoading(e,t){this.setState({loading:e},t)}render(){return a.createElement("div",null,a.createElement("div",{className:s()("threedsecure-iframe-loading",this.state.loading?"":"hidden")},this.props.loadingComponent),a.createElement("iframe",{id:"threedsecure-iframe",frameBorder:"0",scrolling:"no",marginHeight:"0",marginWidth:"0",ref:"threeDSecureIframe",className:s()("threedsecure-iframe",this.state.loading?"hidden":""),src:this.props.threeDSecureIframeConfig.url}))}}const P=(0,i.connect)((e=>e.paymentIframe),(e=>({actions:(0,n.bindActionCreators)({threeDSecureIframeError:O,threeDSecureIframeTimedOut:k},e)})))(F),U="sas-3ds-iframe",K=({handle3dSecureCancel:e,handle3dSecureFailure:t,handle3dSecureError:r,handle3dSecureSuccess:n,handle3dSecureIframeTimeout:i,threeDSecureProxyUrl:o,threeDSecureDetails:d,spreedlyApiKey:l,threeDSecureUrl:c,loadingComponent:u})=>{const[p,m]=(0,a.useState)(!1),h=(0,a.useRef)();return(0,a.useEffect)((()=>{const a=a=>{const o={loaded:()=>{h.current.contentWindow.postMessage(JSON.stringify({id:U,type:"set",threeDSecureDetails:d,spreedlyApiKey:l,threeDSecureUrl:c}),"*"),m(!0)},success:n,cancelled:e,failure:t,error:r,timeout:i},s=((e="{}")=>{try{return JSON.parse(e)}catch(t){if("object"==typeof e&&e.constructor===Object)return e}})(a.data);s&&s.id===U&&o[s.type]&&o[s.type](s.data)};return window.addEventListener("message",a,!1),function(){window.removeEventListener("message",a,!1)}}),[]),a.createElement("div",null,a.createElement("div",{className:s()("threedsecure-iframe-loading",p?"hidden":"")},u),a.createElement("iframe",{id:"threedsecure-iframe",frameBorder:"0",scrolling:"no",marginHeight:"0",marginWidth:"0",className:"threedsecure-iframe",ref:h,src:o}))};K.defaultProps={handle3dSecureCancel:()=>{},handle3dSecureFailure:()=>{},handle3dSecureError:()=>{},handle3dSecureSuccess:()=>{},handle3dSecureIframeTimeout:()=>{}};const z={timedOut:!1,errorMessage:null,cardDetailsSaved:!1,savingCardDetails:!1,mppSession:null,paymentUnauthorised:null,threeDSecureErrorMessage:null,threeDSecureTimedOut:!1};function V(e=z,t={}){switch(t.type){case S:return{...e,savingCardDetails:!0,cardDetailsSaved:!1,extraDetails:t.payload};case m:return{...e,postingMessage:!0,postMessageBody:t.message};case h:return{...e,postingMessage:!1};case f:return{...e,refresh:!0};case y:return{...e,refresh:!1};case l:return{...e,savingCardDetails:!1,cardDetailsSaved:!0};case c:case E:return{...e,savingCardDetails:!1};case u:return{...e,savingCardDetails:!1,errorMessage:t.payload||{action:"error",error_type:"genericPaymentIframeError"},paymentUnauthorised:(r=t.payload,r&&r.error&&r.error.data&&1014===r.error.data.ErrorNumber||null)};case"paymentIframe/PAYMENT_IFRAME_RESET_TIMEOUT":return{...e,errorMessage:null,timedOut:!1};case p:return{...e,savingCardDetails:!1,timedOut:!0};case v:return{...e,mppSession:t.payload};case g:return{...e,threeDSecureErrorMessage:t.payload||{action:"error",error_type:"genericThreeDSecureIframeError"}};case"paymentIframe/THREED_SECURE_IFRAME_RESET_TIMEOUT":return{...e,threeDSecureErrorMessage:null,threeDSecureTimedOut:!1};case w:return{...e,threeDSecureErrorMessage:t.payload,threeDSecureTimedOut:!0};default:return e}var r}function W(){}function x(e,t,r,a){if(!["focus","input","blur","error"].includes(t))return;const n=new CustomEvent(`spreedlyFieldEvent:${e}`,{detail:{type:t,payload:a}});window.dispatchEvent(n)}function G({onTokenizeSuccess:e,onFailedToLoadError:t,onError:r,onReady:n,getLabel:i,apiKey:o,styles:s,showPlaceholder:l,timeout:c=1e4,onCardTypeChange:u}){const[p,m]=(0,a.useState)(!1),{loaded:h}=(0,d.s_)({src:"https://core.spreedly.com/iframe/iframe-v1.min.js",onFailedToLoadError:t});return(0,a.useEffect)((()=>{if(h&&!p&&window.Spreedly){const a=function(e,t=1e4){const r=setTimeout((()=>{window.Spreedly.removeHandlers(),e({code:"SPREEDLY_READY_TIMEOUT"})}),t);return window.Spreedly.on("ready",(()=>{clearTimeout(r)})),r}(t,c);return function({onTokenizeSuccess:e,onError:t=W,getLabel:r=W,apiKey:a,styles:n,isInitialised:i,setInitialised:o,onReady:s=W,showPlaceholder:d,onCardTypeChange:l=W}){i||(window.Spreedly.init(a,{numberEl:"number",cvvEl:"cvv"}),window.Spreedly.on("ready",(()=>{!function({styles:e="",showPlaceholder:t,getLabel:r}){window.Spreedly.setFieldType("number","tel"),window.Spreedly.setFieldType("cvv","tel"),window.Spreedly.setNumberFormat("prettyFormat"),window.Spreedly.setStyle("number",`width: 100%; box-sizing: border-box; ${e}`),window.Spreedly.setStyle("cvv",`width: 100%; box-sizing: border-box; ${e}`),t&&(window.Spreedly.setPlaceholder("number",r({attribute:"number",key:"placeholder"})),window.Spreedly.setPlaceholder("cvv",r({attribute:"cvv",key:"placeholder"})))}({styles:n,showPlaceholder:d,getLabel:r}),window.Spreedly.on("fieldEvent",x),window.Spreedly.on("fieldEvent",(e=>(t,r,a,n)=>{"number"===t&&"input"===r&&e(n&&n.cardType)})(l)),e&&window.Spreedly.on("paymentMethod",e),window.Spreedly.on("errors",function(e,t){return r=>{const a=["number","cvv"];r.forEach((({attribute:e,key:t})=>{a.includes(e)&&x(e,"error",0,{errorKey:t})}));const n=r.filter((e=>!a.includes(e.attribute))).reduce(((e,{attribute:r,key:a})=>r&&a?(e.push({attribute:r,key:a,label:t({attribute:r,key:a})}),e):e),[]);e(n)}}(t,r)),o(!0),s()})))}({apiKey:o,getLabel:i,isInitialised:p,onReady:n,onError:r,onTokenizeSuccess:e,setInitialised:m,styles:s,showPlaceholder:l,onCardTypeChange:u}),()=>clearTimeout(a)}}),[o,i,p,r,t,n,e,h,m,s,l,c,u]),{scriptLoaded:h}}const Z=e=>e.key,j=(0,a.createContext)(Z),$=({children:e,onTokenizeSuccess:t,onFailedToLoadError:r,onError:n,onReady:i,getLabel:o,apiKey:s,styles:d,showPlaceholder:l,timeout:c,onCardTypeChange:u})=>{const{scriptLoaded:p}=G({onTokenizeSuccess:t,onFailedToLoadError:r,onError:n,onReady:i,getLabel:o,apiKey:s,styles:d,showPlaceholder:l,timeout:c,onCardTypeChange:u});return p?a.createElement(j.Provider,{value:o},a.createElement("div",null,e)):null};function Y({attribute:e,luhnValid:t,validCvv:r,validNumber:a}){return Boolean("number"===e?t&&a:r)}function q({attribute:e,numberLength:t,cvvLength:r}){return new Array("number"===e?t:r).fill("*").join("")}function B(e){return t=>function(e,t){function r(e,{type:r,payload:a={},getLabel:n=(()=>{})}){switch(r){case"focus":return{...e,meta:{...e.meta,active:!0}};case"blur":return{...e,meta:{...e.meta,active:!1,touched:!0}};case"input":{const{luhnValid:r,validCvv:i,validNumber:o,numberLength:s,cvvLength:d}=a,l=function({attribute:e,luhnValid:t,validCvv:r,validNumber:a}){return Y({attribute:e,luhnValid:t,validCvv:r,validNumber:a})?void 0:"errors.invalid"}({attribute:t,luhnValid:r,validCvv:i,validNumber:o});return{...e,meta:{...e.meta,invalid:!Y({attribute:t,luhnValid:r,validCvv:i,validNumber:o}),valid:Y({attribute:t,luhnValid:r,validCvv:i,validNumber:o}),error:l&&n({attribute:t,key:l})},value:q({attribute:t,numberLength:s,cvvLength:d})}}case"error":{const{errorKey:r}=a;return{...e,meta:{...e.meta,valid:!1,invalid:!0,touched:!0,active:!1,error:r&&n({attribute:t,key:r})}}}default:return e}}function n(n){const i=(0,a.useContext)(j),o={value:"",meta:{active:!1,invalid:!0,touched:!1,valid:!1,error:i({attribute:t,key:"errors.required"})}},[s,d]=(0,a.useReducer)(r,o),[l,c]=(0,a.useState)({}),u=(0,a.useCallback)((()=>s.meta.error),[s.meta.error]);return(0,a.useEffect)((()=>{const e=({detail:{type:e,payload:t}={}})=>{c(t),d({type:e,payload:t,getLabel:i})};return window.addEventListener(`spreedlyFieldEvent:${t}`,e),()=>window.removeEventListener(`spreedlyFieldEvent:${t}`,e)}),[i]),a.createElement(e,Object.assign({cardDetails:l,key:t,id:t},n,s,{validate:u}))}return n.displayName=`Spreedly${t.charAt(0).toUpperCase()}${t.substring(1)}Field`,n}(t,e)}const J={SPREEDLY_MISSING:"spreedly/SPREEDLY_MISSING",TOKENIZE_PENDING:"spreedly/TOKENIZE_PENDING",TOKENIZE_SUCCESS:"spreedly/TOKENIZE_SUCCESS",TOKENIZE_FAILURE:"spreedly/TOKENIZE_FAILURE"},Q=e=>({type:J.TOKENIZE_SUCCESS,payload:{...e}}),X=e=>({type:J.TOKENIZE_FAILURE,payload:e});var ee=r(17459);const te=window,re=window,ae={KLARNA_MISSING:"klarna/KLARNA_MISSING",AUTHORISE_PENDING:"klarna/AUTHORISE_PENDING",AUTHORISE_SUCCESS:"klarna/AUTHORISE_SUCCESS",AUTHORISE_FAILURE:"klarna/AUTHORISE_FAILURE"},ne=({authorisationToken:e})=>({type:ae.AUTHORISE_SUCCESS,payload:{authorisationToken:e}}),ie=e=>({type:ae.AUTHORISE_FAILURE,payload:{error:e}});r(57595);const oe=B("number"),se=B("cvv"),de={tokenizeCard:(e,t={})=>{const r=(a=Q,n=X,e=>new Promise(((t,r)=>{window.Spreedly.on("paymentMethod",((e,r)=>t({...r,token:e}))),window.Spreedly.on("errors",r),window.Spreedly.tokenizeCreditCard(e)})).then(a,n));var a,n;return async a=>{const{startApmTransaction:n,endApmTransaction:i}=(0,d.CL)("SPREEDLY_TOKENIZE","authorise","span",t);if(n("spreedly"),!window.Spreedly)return i({status:"error",error:"spreedly.missing"}),a({type:J.SPREEDLY_MISSING});a({type:J.TOKENIZE_PENDING});const o=await r(e);switch(o.type){case J.TOKENIZE_SUCCESS:i({status:"success"});break;case J.TOKENIZE_FAILURE:i({status:"error",error:Array.isArray(null==o?void 0:o.payload)?JSON.stringify(o.payload):null==o?void 0:o.payload});break;default:i({status:"unhandled error"})}return a(o)}}},le={authoriseKlarna:e=>{const t=(r=ne,a=ie,({paymentMethod:e="pay_now",autoFinalise:t=!0}={})=>{const n={paymentMethod:e},{startApmTransaction:i,endApmTransaction:o}=(0,d.CL)(ee.S1,"authorise","span",n);return new Promise((async(r,a)=>{var n;i("klarna");try{null===(n=te.Klarna)||void 0===n||n.Payments.authorize({payment_method_category:e,auto_finalize:t},(({approved:e,show_form:t,authorization_token:n,error:i})=>i?(o({status:"error",error:JSON.stringify(i)}),a(i)):t&&e?(o({status:"success"}),r({authorisationToken:n})):(o({status:"cancelled"}),a(new Error(ee.ic)))))}catch(e){return e instanceof Error&&(e.name===ee.C||e.name===ee.bf)?(o({status:e.name}),a(e)):(o({status:"unhandled error"}),a(new Error(ee.Pw)))}})).then(r,a)});var r,a;return async r=>re.Klarna?(r({type:ae.AUTHORISE_PENDING}),r(await t(e))):r({type:ae.KLARNA_MISSING})}}},17459:(e,t,r)=>{r.d(t,{UW:()=>a,S1:()=>n,_b:()=>i,EJ:()=>o,Ii:()=>s,OV:()=>d,$M:()=>l,Pw:()=>c,ic:()=>u,C:()=>p,bf:()=>m});const a="KLARNA",n="KLARNA_AUTHORISE",i="KLARNA_SHOW_FORM",o="KLARNA_INIT",s="https://x.klarnacdn.net/kp/lib/v1/api.js",d="ShowFormRejected",l="invalidFields",c="AuthorisationError",u="AuthorisationCancelled",p="ApplicationNotLoadedError",m="PaymentMethodCategoryNotSupportedError"},57595:(e,t,r)=>{r.d(t,{Z:()=>l});var a=r(67294),n=r(46866),i=r(17459);const o=window,s=window,d=e=>{const{onFailedToLoadError:t,clientToken:r,loadCallback:d,container:l,klarnaApiUrl:c,apmTransactionData:u}=e,[p,m]=(0,a.useState)(!1),[h,f]=(0,a.useState)(!1),[y,E]=(0,a.useState)(!1),{loaded:S}=(0,n.s_)({src:c||i.Ii,client:i.UW,onFailedToLoadError:t}),{startApmTransaction:v,endApmTransaction:g}=(0,n.CL)(i.EJ,"init","span",u),w=(0,n.D9)(r);return(0,a.useEffect)((()=>{w!==r&&(m(!1),f(!1))}),[r,w]),(0,a.useEffect)((()=>{v("klarna")}),[]),(0,a.useEffect)((()=>(S&&!y&&setTimeout((()=>{E(!0)}),500),S&&y&&!p&&(e=>{var t;const{onFailedToLoadError:r,clientToken:a,setInitialised:n,endApmTransaction:i}=e;try{null===(t=o.Klarna)||void 0===t||t.Payments.init({client_token:a}),n(!0)}catch(e){r({code:e.name}),i({error:e.name,errorMessage:e.message})}})({setInitialised:m,onFailedToLoadError:t,clientToken:r,endApmTransaction:g}),S&&y&&p&&!h&&(e=>{var t;const{container:r,paymentMethod:a="pay_now",loadCallback:n,onFailedToLoadError:i,endApmTransaction:o,setKlarnaLoaded:d}=e;try{null===(t=s.Klarna)||void 0===t||t.Payments.load({container:`#${r}`,payment_method_category:a},n),d(!0)}catch(e){i({code:e.name}),o({error:e.name,errorMessage:e.message})}})({container:l,loadCallback:d,onFailedToLoadError:t,endApmTransaction:g,setKlarnaLoaded:f}),function(){g()})),[p,h,y,S]),{scriptInitialised:p}},l=({onFailedToLoadError:e,onError:t,clientToken:r,containerSelector:o="klarna-payments-container",klarnaApiUrl:s,onIframeReady:l})=>{const c={clientToken:r},{startApmTransaction:u,endApmTransaction:p}=(0,n.CL)(i._b,"show form","span",c);(0,a.useEffect)((()=>{u("klarna")}),[]);const{scriptInitialised:m}=d({clientToken:r,onFailedToLoadError:e,loadCallback:r=>{if(r.show_form)if(r.error){const e=r.error.invalid_fields.map((e=>e.replace(/\./g,"_"))),a=`${i.$M}_${e.join("_").toUpperCase()}`;p({status:"error",error:a}),t({code:a})}else p({status:"success"}),null==l||l();else p({error:i.OV}),e({code:i.OV})},container:o,klarnaApiUrl:s,apmTransactionData:c});return m?a.createElement("div",{style:{width:"100%",display:"flex",justifyContent:"center"},id:o}):null}},46866:(e,t,r)=>{function a(e,t){const r={preloadMessages:[],loaded:!1,init(e,t){this.element=e,this.id=t.id,this.onMessageHandler=({data:e})=>{try{this.onMessage(JSON.parse(e))}catch(t){"object"==typeof e&&e.constructor===Object&&this.onMessage(e)}},this.eventHandlers={card_details_saved:t.onCardDetailsSaved,loaded:()=>{this.loaded=!0,this.postMessage({action:"loaded_acknowledged"});for(let e=0;e<this.preloadMessages.length;e++)this.postMessage(this.preloadMessages[e]);t.onLoad&&t.onLoad()},resize_payment_iframe:t.onPaymentIframeResize,resize_skypay:t.onPaymentIframeResize,error:t.onError,"3d_secure_required":t.on3dSecureRequired,"3d_secure_success":t.on3dSecureSuccess,"3d_secure_cancelled":t.on3dSecureCancelled,"3d_secure_failed":t.on3dSecureFailed,validation_failed:t.onValidationFailed,on_message:t.onMessage},window.addEventListener("message",this.onMessageHandler),this.loadingTimeout=setTimeout((()=>{this.loaded||t.onLoadTimeout&&t.onLoadTimeout()}),t.timeout||1e4)},amountField(e){const t={...e};t.action="set_amount_field_properties",this.postMessage(t)},securityCodeField(e){const t={...e};t.action="set_security_code_field_properties",this.postMessage(t)},setupAsChangePaymentMethod(){this.postMessage({action:"setup_as_change_payment_method"})},fullAmountSelected(e){this.amountField({show:!1,value:e})},partialAmountSelected(){this.amountField({show:!0})},resize:function(e){this.postMessage({action:"resize",isMobile:e})},sendTo3dSecure(){this.postMessage({action:"send_to_3d_secure"})},saveCardDetails(e){let t;t=void 0===e?{}:e,t.action="save_card_details",this.postMessage(t)},onMessage(e){if(e.id===this.id){const t=this.eventHandlers.on_message;t&&t(e);const r=this.eventHandlers[e.action];r&&r(e)}else if(void 0!==e.MD&&void 0!==e.PaRes){const t=this.eventHandlers["3d_secure_success"];t&&t({md:e.MD,paResponse:e.PaRes})}},postMessage(e){if(this.loaded){const t={...e};t.id=this.id,this.element.contentWindow.postMessage(JSON.stringify(t),"*")}else this.preloadMessages.push(e)},callbacks:()=>t,unmount(){window.removeEventListener("message",this.onMessageHandler,!1),clearTimeout(this.loadingTimeout)}};return r.init(e,t),r}r.d(t,{wV:()=>n,cf:()=>i,CL:()=>s,D9:()=>p,s_:()=>u}),"undefined"!=typeof window&&(window.initClient=a);const n=a,i=(e="04")=>{var t,r,a,n,i,o,s,d,l,c,u,p;const m=null!==(r=null===(t=null===window||void 0===window?void 0:window.screen)||void 0===t?void 0:t.width)&&void 0!==r?r:"",h=null!==(n=null===(a=null===window||void 0===window?void 0:window.screen)||void 0===a?void 0:a.height)&&void 0!==n?n:"",f=null!==(o=null===(i=null===window||void 0===window?void 0:window.screen)||void 0===i?void 0:i.colorDepth)&&void 0!==o?o:"",y=null!==(d=null===(s=null===window||void 0===window?void 0:window.navigator)||void 0===s?void 0:s.userAgent)&&void 0!==d?d:"",E=null!==(c=null===(l=null===window||void 0===window?void 0:window.navigator)||void 0===l?void 0:l.javaEnabled())&&void 0!==c&&c,S=null!==(p=null===(u=null===window||void 0===window?void 0:window.navigator)||void 0===u?void 0:u.language)&&void 0!==p?p:"";return{screenWidth:m,screenHeight:h,colorDepth:f,userAgent:y,timeZoneOffset:(new Date).getTimezoneOffset(),language:S,javaEnabled:E,browserSize:e,acceptHeader:"*/*"}},o={};function s(e,t,r,a){const n="undefined"!=typeof window&&Boolean(window.elasticApm),i=[e,t,r].join("-");return{startApmTransaction:function(a){const s=o[i];if(n&&!s){const n=window.elasticApm.startTransaction(e,a),s=n.startSpan(t,r);o[i]={transaction:n,transactionSpan:s}}},endApmTransaction:function(e){const t=o[i];n&&t&&(t.transaction.addLabels({...a,...e&&e}),t.transactionSpan.end(),t.transaction.end(),delete o[i])},addLabels:function(e){const t=o[i];n&&t&&t.transaction.addLabels({...a,...e&&e})}}}var d=r(67294);let l={};const c=()=>{},u=e=>{const{src:t,maxRetries:r=3,client:a="SPREEDLY",onFailedToLoadError:n=c,createElement:i=null,addElement:o=null}=e,[s,u]=(0,d.useState)({loaded:!1,error:!1}),[p,m]=(0,d.useState)(r);return(0,d.useEffect)((()=>{if(l[t])u({loaded:!0,error:!1});else{if(!(p<=0)){const e=i||document.createElement.bind(document),r=o||document.body.appendChild.bind(document.body);l[t]=!0;const a=e("script");a.src=t;const n=()=>u({loaded:!0,error:!1}),s=()=>{l[t]=!1,a.remove(),u({loaded:!1,error:!0}),m((e=>e-1))};return a.addEventListener("load",n),a.addEventListener("error",s),r(a),()=>{a.removeEventListener("load",n),a.removeEventListener("error",s)}}u({loaded:!1,error:!0}),n({code:`${a}_SCRIPT_FAILED_TO_LOAD`})}}),[o,i,n,p,t,a]),{loaded:s.loaded,error:s.error,retries:p}};function p(e){const t=(0,d.useRef)();return(0,d.useEffect)((()=>{t.current=e})),t.current}}}]);
//# sourceMappingURL=9698.6880dac49e5afd2c6a90.min.js.map